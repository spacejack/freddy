<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<!--
Copyright (c) 2015 by Mike Linkovich
http://www.spacejack.ca/
-->
	<meta name="viewport" content="width=device-width,initial-scale=1"/>
	<meta name="mobile-web-app-capable" content="yes"/>
	<meta name="apple-mobile-web-app-capable" content="yes"/>
	<meta id="meta_theme_color" name="theme-color" content="#444444"/>
	<meta id="meta_ios_theme_color" name="apple-mobile-web-app-status-bar-style" content="black"/>
	<meta property="og:title" content="Freddy"/>
	<meta property="og:description" content="A fast mobile Reddit reader"/>
	<meta property="og:image" content="http://www.spacejack.ca/freddy/img/share.png"/>
	<title>Freddy</title>
	<link rel="icon" sizes="192x192" href="img/icon-192.png"/>
	<link rel="apple-touch-icon" sizes="192x192" href="img/icon-192.png"/>
<style>
button,html,input,select,textarea{-webkit-tap-highlight-color:transparent}
button,select{font-size:1em;color:#AAA;background:#333;border-color:#888}
button,input[type=text]{border-width:1px;margin:0}
h1,h2{-webkit-user-select:none;-ms-user-select:none;-moz-user-select:none;font-weight:700}
h1,h2,h3{font-weight:700}
body,button,hr,select{margin:0}
blockquote,body,hr,li,ol,ul{padding:0}
.item_right,.logo_svg{vertical-align:bottom}
*{font-family:Myriad,helvetica,arial}
body,html{height:100%}
body{color:#AAA;background:#444}
html{-webkit-text-size-adjust:none;-ms-text-size-adjust:none}
select{padding:.5em}
button{cursor:pointer;border-style:solid;padding:.5em 1.5em}
button::-moz-focus-inner{border:0;padding:0}
button:hover{color:#CCC;background:#555}
button:disabled{cursor:default;background:rgba(0,0,0,.25);color:rgba(.5,.5,.5,.5)}
input[type=text]{font-size:1.2em;padding:.2em;color:#CCC;background:rgba(255,255,255,.05);border-color:#666}
input[type=checkbox]{display:inline-block;transform:scale(1.8,1.8);-webkit-transform:scale(1.8,1.8);padding:0;margin:.9em 1em .5em .9em}
a{text-decoration:none;color:#89A}
p{margin:.2em 0}
blockquote{margin:.1em 0 0 .7em;font-style:italic;font-size:.95em}
ol,ul{margin:0 0 0 1em}
li{margin:.05em 0}
h1{font-size:1.5em;user-select:none;cursor:default}
h2{font-size:1.3em;user-select:none}
.clickable,.panel_head{-webkit-user-select:none;-ms-user-select:none;-moz-user-select:none}
h3{font-size:1.2em}
h4{font-size:1.1em;font-weight:400}
.feed_meta_body,code{font-size:.85em}
hr{border:none;height:1px;background-color:#999}
.ico_arrow_left,.ico_arrow_right{width:0;height:0;border-top:.35em solid transparent;border-bottom:.35em solid transparent}
pre{background:#3F3F3F;padding:.35em .5em;margin:.1em .5em .1em 0;overflow-x:auto}
.btn_arrow,.btn_menu{display:inline-block;padding:0 .5em}
code{font-family:consolas,monospace;color:#6C9}
.color_link{color:#89A}
.ico_arrow_left{border-right:.5em solid #999}
.ico_arrow_right{border-left:.5em solid #999}
.container,.panel{width:100%;height:100%;left:0}
.item:not(:first-child),.subreddit_item:not(:first-child){border-top:#999 solid 1px}
.btn_arrow{background:#282828}
.btn_arrow:hover,.btn_arrow_press{color:#DDD;background:#202020}
.btn_menu{background:#282828;cursor:pointer}
.btn_menu:hover,.btn_menu_press{color:#DDD;background:#202020}
.clickable{cursor:pointer;user-select:none}
.container{position:fixed;top:0;overflow:hidden}
.panel{position:absolute;right:0;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;transform:translate3d(0,0,0);-webkit-transform:translate3d(0,0,0)}
.feed_panel{background:#444;box-shadow:0 0 50px rgba(0,0,0,.75)}
.logo_svg{height:1.1em;width:1.1em;margin-right:.5em}
.feed_meta_body hr{margin:.75em 0}
.feed_meta_body h1,.feed_meta_body h2,.feed_meta_body h3,.feed_meta_body h4{margin:.4em 0;padding:0}
.article_panel{background:#444;box-shadow:0 0 50px rgba(0,0,0,.5)}
.panel_head{width:100%;line-height:1.3em;font-weight:700;font-size:1.4em;padding:.5em .3em;box-shadow:0 5px 10px rgba(0,0,0,.5);background:#333;color:#BBB;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;z-index:10;user-select:none;cursor:default}
.item_right,.item_title{-webkit-user-select:none;-ms-user-select:none;-moz-user-select:none}
.article_image_img,.item_right,.item_thumb,.item_title,.subreddit_item{cursor:pointer}
.panel_content{height:100%;overflow-y:scroll;-webkit-overflow-scrolling:touch}
.item{display:table;width:100%}
.item_left{display:table-cell;padding:0 .5em .4em}
.item_left_press{background:#4A4A4A;color:#DDD}
.item_right{display:table-cell;font-size:1.125em;font-weight:700;text-align:center;margin-right:.5em;padding-bottom:.3em;background:#444C55;width:4em;user-select:none}
.item_right_press{background:#456;color:#DDD}
.item_thumb{float:left;margin-right:.5em;margin-top:.73em;width:2.5em;height:2.5em}
.item_title{font-size:1.2em;font-weight:400;margin:.5em 0 0;user-select:none}
.feed_loadmore_block,.item_details{-webkit-user-select:none;-ms-user-select:none;-moz-user-select:none}
.item_details{font-size:.8em;user-select:none}
.feed_loadmore_block{text-align:center;padding:.7em 0;box-shadow:inset 0 .5em 15px rgba(0,0,0,.25);user-select:none;background:#393939;cursor:pointer}
.subreddit_block{padding:0 0 0 10px}
.subreddit_item{position:relative;font-size:1.2em;padding:.4em 0;-webkit-user-select:none;-ms-user-select:none;-moz-user-select:none;user-select:none}
.subreddit_item_press{background:#555}
.subreddit_item_text{position:absolute}
.subreddit_item_delete{position:absolute;left:72%;background:#3A3A3A;padding:0 .5em}
.subreddit_item_delete:hover,.subreddit_item_delete_press{background:#333}
.article_block{padding:.5em .5em .25em;margin:1em .5em .7em;background:#3F3F3F;border:1px solid #777;overflow:auto}
.article_loading{position:fixed;left:0;top:5em;width:100%;text-align:center}
.menu_bg,.menu_content,.viewer_bg,.viewer_content{left:0;top:0;height:100%}
.article_title{padding-top:0;margin-top:0;font-size:1.1em}
.article_body{word-wrap:break-word;font-size:.85em}
.article_info{font-size:.7em}
.article_image_block{float:left;margin-right:.5em}
.article_comments{overflow-x:hidden;margin-right:.5em}
.article_comment_block{margin:.1em 0 .1em .6em}
.article_comment_head{margin-top:.4em;font-size:.7em}
.article_comment_body{font-size:.85em;padding-left:.5em;padding-right:.1em;padding-bottom:.2em;border-left:#666 solid 2px;border-bottom:#666 solid 1px;margin-bottom:.6em}
.btn_left,.btn_right{padding:0 .5em;cursor:pointer}
.btn_right{float:right}
.txt_subreddit_add{width:50%}
.viewer_bg{position:absolute;width:100%;background:rgba(0,0,0,.9)}
.viewer_content{position:relative;width:100%;display:-webkit-flex;display:flex;-webkit-flex-direction:row;flex-direction:row;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center}
.menu_bg{position:absolute;width:100%;background:rgba(0,0,0,.65)}
.menu_content{position:relative;width:100%;display:-webkit-flex;display:flex;-webkit-flex-direction:row;flex-direction:row;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center}
.menu_block{position:relative;min-width:50%;max-width:75%;max-height:95%;display:inline-block;text-align:center;overflow:auto}
.menu_title{padding:0 0 .6em;font-size:1.5em}
.menu_text{padding:0 0 .4em;font-size:1em}
.menu_items{background:#333;box-shadow:10px 20px 20px rgba(0,0,0,.25)}
.menu_item{padding:.5em 1em;font-size:1.2em;font-weight:700;cursor:pointer}
.menu_item:not(:first-child){border-top:#555 solid 1px}
.menu_item:hover{background:#444}
.loading_message{width:100%;padding:1em 0;text-align:center}

</style>
</head>
<body>
<div id="container" class="container">
	<div id="left_panel" class="panel left_panel">
		<div id="left_panel_head" class="panel_head">
			<div style="display:inline-block"><svg class="logo_svg"
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   version="1.1"
   width="255.10962"
   height="289.3222"
   viewBox="0 0 255.10962 289.3222"
   id="svg3015">
  <metadata
     id="metadata3043">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <defs
     id="defs3041" />
  <g
     transform="translate(-0.44518681,-70.765714)"
     id="g3017">
    <path
       d="M 255.55481,70.765714 232.31367,331.12545 127.84387,360.08791 23.661714,331.16624 0.44518681,70.765714 l 255.10962319,0 0,0 z"
       id="path3019"
       style="fill:#e44d26" />
    <path
       d="m 128,337.95024 84.4167,-23.4036 19.8611,-222.489321 -104.2778,0 0,245.892921 0,0 z"
       id="path3021"
       style="fill:#f16529" />
    <g
       transform="matrix(0.55959928,0,0,0.55959928,39.523149,103.621)"
       id="g3158">
      <circle
         cx="49.683998"
         cy="11.836"
         r="2.7019999"
         transform="matrix(12.584949,0,0,12.584949,-606.28198,6.4761424)"
         id="circle21800"
         style="fill:#ffffff;stroke:#000000;stroke-width:1.10000002" />
      <circle
         cx="71.786003"
         cy="11.836"
         r="2.7019999"
         transform="matrix(12.584949,0,0,12.584949,-606.28198,6.4761424)"
         id="circle21802"
         style="fill:#ffffff;stroke:#000000;stroke-width:1.10000002" />
      <path
         d="m 252.33876,36.075942 c 0,0 0,0 -68.00906,-16.008055 l -24.99371,79.008309"
         id="path21804"
         style="fill:none;stroke:#000000;stroke-width:13.84344387;stroke-linecap:round;stroke-linejoin:round" />
      <circle
         cx="70.431"
         cy="2.789"
         r="2.1300001"
         transform="matrix(12.584949,0,0,12.584949,-606.28198,6.4761424)"
         id="circle21808"
         style="fill:#ffffff;stroke:#000000;stroke-width:1.10000002" />
      <ellipse
         cx="60.675999"
         cy="15.552"
         rx="12.238"
         ry="7.987"
         transform="matrix(12.584949,0,0,12.584949,-606.28198,6.4761424)"
         id="ellipse21820"
         style="fill:#ffffff;stroke:#000000;stroke-width:1.10000002" />
      <g
         transform="matrix(12.584949,0,0,12.584949,-606.28198,6.4761424)"
         id="g21824">
        <path
           d="m 135.90625,159.65625 c -13.67995,0 -25.15625,11.4763 -25.15625,25.15625 0,13.67995 11.4763,24.78125 25.15625,24.78125 13.67995,0 24.78125,-11.1013 24.78125,-24.78125 0,-13.67995 -11.1013,-25.15625 -24.78125,-25.15625 z"
           transform="matrix(0.07946,0,0,0.07946,45.637601,-0.68559946)"
           id="circle21826"
           style="fill:#ff4500;stroke:none" />
        <path
           d="m 244.46875,159.65625 c -13.68691,0 -25.1875,11.46934 -25.1875,25.15625 0,13.68691 11.50059,24.78125 25.1875,24.78125 13.68692,0 24.78125,-11.09434 24.78125,-24.78125 0,-13.68691 -11.09433,-25.15625 -24.78125,-25.15625 z"
           transform="matrix(0.07946,0,0,0.07946,45.637601,-0.68559946)"
           id="circle21828"
           style="fill:#ff4500;stroke:none" />
        <path
           d="m 56.507,19.229 c 1.066,1.066 2.786,1.271 4.212,1.271"
           id="path21830"
           style="fill:none;stroke:#000000;stroke-width:1.10000002;stroke-linecap:round" />
        <path
           d="M 64.963,19.229 C 63.896,20.295 62.177,20.5 60.75,20.5"
           id="path21832"
           style="fill:none;stroke:#000000;stroke-width:1.10000002;stroke-linecap:round" />
      </g>
      <circle
         cx="70.431"
         cy="2.789"
         r="2.1300001"
         transform="matrix(12.584949,0,0,12.584949,-781.19627,145.90057)"
         id="circle3170"
         style="fill:#84ffff;fill-opacity:1;stroke:#000000;stroke-width:1.10000002" />
      <circle
         cx="70.431"
         cy="2.789"
         r="2.1300001"
         transform="matrix(12.584949,0,0,12.584949,-676.4167,145.90057)"
         id="circle3172"
         style="fill:#84ffff;fill-opacity:1;stroke:#000000;stroke-width:1.10000002" />
      <rect
         width="56.614769"
         height="16.899933"
         x="129.33502"
         y="162.28896"
         id="rect3174"
         style="fill:#000000;fill-opacity:1;stroke:none" />
    </g>
  </g>
</svg>Freddy</div>		</div>
		<div id="left_panel_content" class="panel_content">
			<div id="subreddit_block" class="subreddit_block">
				<h2>Subreddits</h2>
				<div id="subreddit_list" class="subreddit_list">
				</div>
				<hr/>
				<div id="subreddit_add_block" style="margin-bottom:1em">
					<h2>Add Subreddit:</h2>
					<p>
						<input id="txt_subreddit_add" class="txt_subreddit_add" type="text" maxlength="21"/>
						<button id="btn_subreddit_add" style="margin-left:0.4em">Add</button>
					</p>
				</div>
				<hr/>
				<div id="options_block" class="options_block">
					<h2>Options:</h2>
					<p style="margin-bottom: 1em">
						Theme:
						<button id="btn_theme" style="margin-left: 0.4em">Default</button>
					</p>
					<p><input type="checkbox" id="chk_article_images" /> Show article images</p>
					<p><input type="checkbox" id="chk_thumb_images" /> Show thumbnail images</p>
					<p><input type="checkbox" id="chk_history" /> Use back button</p>
					<p><input type="checkbox" id="chk_nsfw" /> Show NSFW content (18+)</p>
					<p><input type="checkbox" id="chk_savecookie" /> Save options in cookie</p>
				</div>
			</div>
		</div>
	</div>
	<div id="right_panel" class="panel right_panel">
		<div id="right_panel_head" class="panel_head">
			<div style="display:inline-block;padding-left: 0.55em">Sidebar</div>
		</div>
		<div id="right_panel_content" class="panel_content" style="padding-right:20%">
			<div style="padding:1em 0.4em 0em 1.5em">
				<p><b>Freddy</b>. A fast Reddit reader.</p>
				<p style="font-size:0.85em">&copy; 2015 by Mike Linkovich</p>
				<p><a href="https://www.github.com/spacejack/freddy" target="_blank">Github Repo</a></p>
				<p id="homescreen_note" style="font-size:0.75em">This app works better when you add it to your homescreen.</p>
			</div>
			<div id="feed_meta_block" style="padding:1em 0.4em 0em 1.5em">
				<hr/>
				<h2 id="feed_meta_name">{sub}</h2>
				<p id="feed_meta_body" class="feed_meta_body"></p>
			</div>
		</div>
	</div>
	<div id="feed_panel" class="panel feed_panel" touch-action="none">
		<div id="feed_panel_head" class="panel_head">
			<div style="float:left;max-width:70%;overflow:hidden;white-space:nowrap">
				<div id="btn_feed_l" class="btn_arrow clickable" style="margin-right:0.5em;" touch-action="none">&#9666;</div><div id="feed_title_text" style="display:inline-block">Frontpage</div>
			</div>
			<div style="float:right;text-align:right">
				<div id="btn_feed_menu" class="btn_menu" touch-action="none">&middot;&middot;&middot;</div><div id="btn_feed_r" class="btn_arrow clickable" style="margin-left:0.25em" touch-action="none">&#9656;</div>
			</div><br clear="all"/>
		</div>
		<div id="feed_panel_content" class="panel_content">
		</div>
	</div>
	<div id="article_panel" class="panel article_panel" style="visibility:hidden" touch-action="none">
		<div id="article_panel_head" class="panel_head">
			<div id="btn_article_close" class="btn_arrow clickable" touch-action="none" style="margin-right:0.5em">&#9666;</div><div id="article_title_text" style="display:inline-block">Article comments</div>
		</div>
		<div id="article_loading" class="article_loading" style="display:none;">loading...</div>
		<div id="article_panel_content" class="panel_content">
			<div id="article_block" class="article_block">
				<div id="article_image_block" class="article_image_block"></div>
				<p id="article_title" class="article_title"></p>
				<p id="article_info" class="article_info"></p>
				<p id="article_body" class="article_body"></p>
			</div>
			<div id="article_comments" class="article_comments"></div>
		</div>
	</div>
	<div id="menu_bg" class="menu_bg" style="display:none" touch-action="none">
		<div id="menu_content" class="menu_content"></div>
	</div>
	<div id="viewer_bg" class="viewer_bg" style="display:none">
		<div id="viewer_content" class="viewer_content" touch-action="none"></div>
	</div>
</div>
<script>
(function(){"use strict";var e=function(){function e(e){var t=null;return e&&(t="#"===e.charAt(0)?document.getElementById(e.substr(1)):document.querySelectorAll(e)),t}return e}();!function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var n=Date().now,i=Math.max(0,16-(n-e)),o=window.setTimeout(function(){t(n+i)},i);return e=n+i,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),e.copy=function(e,t){t=t||{};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},e.browser=function(){function e(e){e=e||r,e=(""+e).toLowerCase();for(var t=0,n=c.length;n>t;++t)if(e.indexOf(c[t])>=0)return!1;return!0}function t(){return void 0!==navigator.standalone?!!navigator.standalone:window.external&&window.external.msIsSiteMode?!!window.external.msIsSiteMode():!1}function n(){return a.indexOf("https")>=0}function i(){return window.self!==window.top}function o(){return{width:screen.width*s,height:screen.height*s}}var r=window.location.hostname||"",a=window.location.protocol||"",s=window.devicePixelRatio||1,c=["spacejack.ca","spacejack.github"],l={Android:function(){return!!navigator.userAgent.match(/Android/i)},BlackBerry:function(){return!!navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return!!navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return!!navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return!!navigator.userAgent.match(/IEMobile/i)},FirefoxOS:function(){return!!navigator.userAgent.match(/\(Mobile/i)},any:function(){return l.Android()||l.BlackBerry()||l.iOS()||l.Opera()||l.Windows()||l.FirefoxOS()}};return{domainIsLocal:e,isStandalone:t(),isSecure:n(),isFramed:i(),hostname:r,protocol:a,screenSize:o(),pixelRatio:s,isMobile:l}}(),e.math={sign:function(e){return e>0?1:0>e?-1:0},clamp:function(e,t,n){return Math.min(Math.max(e,t),n)},length2d:function(e,t){return Math.sqrt(e*e+t*t)},pmod:function(e,t){return(e%t+t)%t}},e.string=function(){function e(e){return/^\s+$/.test(e)}function t(e){return!e||"string"!=typeof e||e.length<1?"":e.charAt(0).toUpperCase()+e.substr(1)}function n(e,t){return e.toUpperCase()===t.toUpperCase()}function i(){var e,t,n=[],i=[];for(e=0,t=arguments.length;t>e;e++)n=n.concat(arguments[e].split("/"));for(i=[],e=0,t=n.length;t>e;e++){var o=n[e];o&&"."!==o&&(".."===o?i.pop():i.push(o))}return""===n[0]&&i.unshift(""),i.join("/")||(i.length?"/":".")}function o(e){return i(e,"..")}return{cieq:n,capitalize:t,isWhitespace:e,joinPaths:i,dirName:o}}(),e.pointer=function(){function t(t,r){function f(e,i,o,a){return H||u!==n&&u!==a?(console.log("cancelling "+s[a]+" press"),o.preventDefault(),o.stopPropagation(),!1):(P.x=D.x=e,P.y=D.y=i,H=!0,I=!1,u=a,r.pressClassStr&&(t.className=R+" "+r.pressClassStr),r.onPress&&r.onPress(e,i,o,a),!0)}function h(){window.setTimeout(function(){H||(u=n)},c)}function m(e,n,i,o){return H?(D.x=e,D.y=n,H=!1,r.pressClassStr&&(t.className=R),h(),!0):(o!==u&&i.stopPropagation(),!1)}function p(t,n,i,o){if(!H)return!1;if(o!==u)return i.stopPropagation(),!1;D.x=t,D.y=n;var a=e.math.length2d(t-P.x,n-P.y);return a>l&&g(),r.onMove&&r.onMove(t,n,i,o),!0}function g(){I=!0,r.pressClassStr&&(t.className=R),r.onCancelClick&&r.onCancelClick()}function v(e,t,n,i){return m(e,t,n,i)?(r.onRelease&&r.onRelease(e,t,n,i),!I&&r.onClick&&r.onClick(n),!0):!1}function w(e,t,n,i){return m(e,t,n,i)?(r.onCancel&&r.onCancel(e,t,n,i),!0):!1}function _(){d?(t.removeEventListener("MSPointerStart",T,!!O.press),t.removeEventListener("MSPointerMove",L,!!O.move),t.removeEventListener("MSPointerEnd",A,!!O.release),t.removeEventListener("MSPointerCancel",E,!!O.cancel),t.removeEventListener("MSPointerOut",E,!!O.cancel)):(t.removeEventListener("touchstart",b,!!O.press),t.removeEventListener("touchmove",y,!!O.move),t.removeEventListener("touchend",x,!!O.release),t.removeEventListener("touchcancel",k,!!O.cancel),e.browser.isMobile.iOS()||(t.removeEventListener("mousedown",S,!!O.press),t.removeEventListener("mousemove",C,!!O.move),t.removeEventListener("mouseup",M,!!O.release)))}function b(e){f(e.changedTouches[0].clientX,e.changedTouches[0].clientY,e,o)}function y(e){p(e.changedTouches[0].clientX,e.changedTouches[0].clientY,e,o)}function x(e){v(e.changedTouches[0].clientX,e.changedTouches[0].clientY,e,o)}function k(e){w(e.changedTouches[0].clientX,e.changedTouches[0].clientY,e,o)}function S(e){f(e.clientX,e.clientY,e,i)}function C(e){p(e.clientX,e.clientY,e,i)}function M(e){v(e.clientX,e.clientY,e,i)}function T(e){f(e.clientX,e.clientY,e,a)}function L(e){p(e.clientX,e.clientY,e,a)}function A(e){v(e.clientX,e.clientY,e,a)}function E(e){w(e.clientX,e.clientY,e,a)}r=r||{};var O=r.capture||{},R=t.className,H=!1,P={x:0,y:0},D={x:0,y:0},I=!1;return d?(t.addEventListener("MSPointerStart",T,!!O.press),t.addEventListener("MSPointerMove",L,!!O.move),t.addEventListener("MSPointerEnd",A,!!O.release),t.addEventListener("MSPointerCancel",E,!!O.cancel),t.addEventListener("MSPointerOut",E,!!O.cancel)):(t.addEventListener("touchstart",b,!!O.press),t.addEventListener("touchmove",y,!!O.move),t.addEventListener("touchend",x,!!O.release),t.addEventListener("touchcancel",k,!!O.cancel),e.browser.isMobile.iOS()||(t.addEventListener("mousedown",S,!!O.press),t.addEventListener("mousemove",C,!!O.move),t.addEventListener("mouseup",M,!!O.release))),{isPressed:function(){return H},inputDevice:function(){return u},startPos:function(){return{x:P.x,y:P.y}},curPos:function(){return{x:D.x,y:D.y}},cancelClick:g,clickCancelled:function(){return I},remove:_,usingPointerAPI:d}}var n=0,i=1,o=2,r=4,a=i|o|r,s=["none","mouse","touch"],c=200,l=16,u=n,d=!!window.navigator.msPointerEnabled;return d&&console.log("using Pointer Events API"),t}(),e.click=function(t,n,i,o){return e.pointer(t,{onClick:n,capture:{press:i,release:i,move:i},pressClassStr:o})},e.html=function(){return{unescape:function(e){if(!e)return"";var t=document.createElement("div");t.innerHTML=e;var n=t.childNodes[0];return n?n.nodeValue:""},setLinkTargets:function(e,t){var n=e.querySelectorAll("a");if(n)for(var i=0,o=n.length;o>i;++i)n[i].setAttribute("target",t)},setLinkDomains:function(t,n,i){i=void 0===i?!0:!!i;var o,r,a=t.querySelectorAll("a");if(a)for(var s=0,c=a.length;c>s;++s)o=a[s],r=o.href,r&&(r.indexOf("://")<0&&("/"!==r.charAt(0)&&(r="/"+r),r=e.browser.protocol+"//"+n+r,o.href=r),0===r.indexOf(e.browser.protocol+"//"+e.browser.hostname)&&(r=r.replace(e.browser.hostname,n),i&&r.indexOf("https:")<0&&(r=r.replace("http:","https:")),o.href=r))},prep:function(t){var n=e.html.unescape(t),i=document.createElement("div");return i.innerHTML=n,e.html.setLinkTargets(i,"_blank"),e.html.setLinkDomains(i,"www.reddit.com",!0),i.innerHTML}}}(),e.date=function(){var e=60,t=3600,n=86400,i=1036800,o=31536e3;return{toAgeString:function(r,a){var s,c,l=a-r,u="";return e>l?u="just now":(t>l?(s=Math.round(l/e),c="minute"):n>l?(s=Math.round(l/t),c="hour"):i>l?(s=Math.round(l/n),c="day"):o>l?(s=Math.round(l/i),c="month"):(s=Math.round(l/o),c="year"),s>1&&(c+="s"),u=s+" "+c+" ago"),u}}}(),e.cookies=function(){return{get:function(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},set:function(e,t,n,i,o,r){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var a="";if(n)switch(n.constructor){case Number:a=n===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:a="; expires="+n;break;case Date:a="; expires="+n.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+a+(o?"; domain="+o:"")+(i?"; path="+i:"")+(r?"; secure":""),!0},remove:function(t,n,i){return t&&e.cookies.exists(t)?(document.cookie=encodeURIComponent(t)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(i?"; domain="+i:"")+(n?"; path="+n:""),!0):!1},exists:function(e){return new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),t=0;t<e.length;t++)e[t]=decodeURIComponent(e[t]);return e}}}(),e.xhr=function(){function e(e,n){n=n||{};var o=n.method||"GET";o=i.indexOf(o.toUpperCase())>=0?o:"GET";var r=n.data,a=n.contentType||"application/x-www-form-urlencoded",s=n.accept||"text/plain",c=!!n.sync,l=n.success,u=n.error;n=null;var d=new XMLHttpRequest;d.overrideMimeType&&d.overrideMimeType(s),d.onreadystatechange=function(){4===d.readyState&&(--t,200===d.status?l&&l(d.responseText):u&&u(d.status))};var f="";for(var h in r)if(r.hasOwnProperty(h)){var m=r[h];f.length>0&&(f+="&"),f+=h+"="+encodeURIComponent(m)}t++,"GET"===o?(f&&(e+="?"+f),d.open("GET",e,!c),d.send("")):(d.open(o,e,!c),d.setRequestHeader("Content-Type",a),d.send(f))}var t=0,n=0,i=["GET","POST","PUT","DELETE"];return e.getNumActiveRequests=function(){return t},e.getCacheSize=function(){return n},e.setCacheSize=function(e){n=e},e}();var t=function(e){e?(this.left=e.left,this.top=e.top,this.right=e.right,this.bottom=e.bottom):(this.left=0,this.top=0,this.right=0,this.bottom=0),this.width=this.right-this.left,this.height=this.bottom-this.top};t.prototype.constructor=t,t.prototype.copy=function(e){return this.left=e.left,this.top=e.top,this.right=e.right,this.bottom=e.bottom,this.width=this.right-this.left,this.height=this.bottom-this.top,this};var n=function(){function e(){function e(e){return e&&"string"==typeof e?e.toLowerCase():""}var t="",n="translate3d(100px,20px,0px)",i=document.createElement("div");i.style.transform=n;var o=e(i.getAttribute("style"));return 0===o.indexOf("transform")?t:(i.style.MozTransform=n,i.style.webkitTransform=n,i.style.msTransform=n,o=e(i.getAttribute("style")),i=null,console.log("testing for beta style attribute in: "+o),t=-1!==o.indexOf("moz")?"moz":-1!==o.indexOf("webkit")?"webkit":-1!==o.indexOf("ms")?"ms":null)}function t(){function t(e,t,n){e.style[i]="translate3d("+t+"px,"+n+"px,0px)"}function o(e,t,n,i,o){function r(){var s=Date.now()-a;s>=i?(e.style.opacity=n,e=null,o&&o()):(e.style.opacity=t+s/i*(n-t),requestAnimationFrame(r))}var a=Date.now();e.style.opacity=t,requestAnimationFrame(r)}function r(e,t,n){o(e,0,1,t,n)}function a(e,t,n){o(e,1,0,t,n)}return i||(i="transform",n=e(),null===n?(console.warn("Browser does not appear to support CSS transform styles."),n=""):n.length>0&&(i="-"+n+"-transform"),console.log("using css transform style name: '"+i+"'")),{setPos:t,fade:o,fadeIn:r,fadeOut:a,transformStyleName:i,transformStylePrefix:n}}var n,i;return t}(),i=function(){function t(e,t,n){n=n||Date.now(),r=0,a=0,s[r].x=e,s[r].y=t,s[r].t=n,r=1,a=1}function n(e,t,n){n=n||Date.now(),s[r].x=e,s[r].y=t,s[r].t=n,r=(r+1)%o,a+=1}function i(t){if(t=t||{x:0,y:0},t.x=0,t.y=0,1>a)return t;var n=a>o?o:a,i=e.math.pmod(r-1,o),c=e.math.pmod(r-n,o),l=(s[i].t-s[c].t)/1e3,u=s[i].x-s[c].x,d=s[i].y-s[c].y;return t.x=u/l,t.y=d/l,t}var o=4,r=0,a=0,s=new Array(o);return function(){for(var e=0;o>e;++e)s[e]={x:0,y:0,t:0}}(),{start:t,add:n,getVel:i}},o=function(){function t(t){function l(e){L.setPos(v,e,0),A.onMove&&A.onMove(e)}function u(e,t,n,i){function o(){var s,c,u=Date.now()-r;u>=n?(l(t),z=!1,i&&i()):(c=Math.pow(u/n,.4),s=e+c*a,l(s),requestAnimationFrame(o))}var r=Date.now(),a=t-e;z=!0,requestAnimationFrame(o)}function d(e,t,n){return n.stopPropagation(),z?void n.preventDefault():(R=!0,H=!1,P=!1,D=!1,I.x=e,I.y=t,F.start(e,t),!1)}function f(t,i,o){if(o.stopPropagation(),z)return o.preventDefault(),!1;if(R&&(F.add(t,i),!D)){var a=t,s=a-I.x;if(!H){if(!P){if(Math.abs(a-I.x)<b)return;P=!0}_===r?s+=T.width*k:_===n&&(s+=T.width*x),s=e.math.clamp(s,T.width*x,T.width*k),l(s)}return P&&o.preventDefault(),!1}}function h(t,i,a){if(z)return a.preventDefault(),void a.stopPropagation();if(P){var s=F.getVel();console.log("swipe vel:",s.x);var l=t-I.x;l=e.math.clamp(l,x*T.width,k*T.width);var d,f=l,h=0;_===r?f=l+T.width*k:_===n&&(f=l+T.width*x);var m=o;m=l<-T.width/2+-.1*s.x?_===o||_===n?n:o:l>T.width/2-.1*s.x?_===o||_===r?r:o:_,m===o?h=y:m===r?h=T.width*k:m===n&&(h=T.width*x),d=Math.max(Math.floor(1.5*M)-.1*Math.abs(s.x),c),u(f,h,d,function(){_=m,A.onChange&&A.onChange(_)})}R=!1,P=!1,D=!1,H=!1}function m(e,t,n,i,o){u(t,n,i,function(){_=e,o&&o()})}function p(e,t){if(z)return!1;if(_===e)return t&&t(),!0;if(e===n){if(!E||_!==o)return!1;m(e,y*T.width,x*T.width,M,t)}else if(e===r){if(!O||_!==o)return!1;m(e,y*T.width,k*T.width,M,t)}else if(_===n)m(e,x*T.width,y*T.width,M,t);else{if(_!==r)return!1;m(e,k*T.width,y*T.width,M,t)}return!0}function g(){_===o?l(T.width*y):_===n?l(T.width*x-S):_===r&&l(T.width*k+C)}var v=t.elPanel,w=t.elScroll,_=t.state||o,b=t.slideThreshold||a,y="number"==typeof t.xSlideCenter?t.xSlideCenter:0,x="number"==typeof t.xSlideLeft?t.xSlideLeft:-1,k="number"==typeof t.xSlideRight?t.xSlideRight:1,S=t.hideDistLeft||0,C=t.hideDistRight||0,M="number"==typeof t.springDur?t.springDur:s,T=t.rcApp,L=t.anim,A={onMove:t.onMove,onChange:t.onChange};t=null;var E=y>x,O=k>y,R=!1,H=!1,P=!1,D=!1,I={x:0,y:0},z=!1,F=i();return e.pointer(v,{onPress:d,onMove:f,onRelease:h}),w.onscroll=function(){H=!0,D=!0,P=!1},{resize:g,go:p}}var n=-1,o=0,r=1,a=20,s=300,c=50;return t.LEFT=n,t.CENTER=o,t.RIGHT=r,t}(),r=function(t){function n(e){f=e}function i(t,n){e.click(t,function(e){n.onclick&&n.onclick(e),s(),p.onSelect&&p.onSelect(n.id)})}function o(){var t='<div class="menu_block">';g.title&&(t+='<div class="menu_title">'+g.title+"</div>"),g.text&&(t+='<div class="menu_text">'+g.text+"</div>"),t+='<div class="menu_items">';var n,o=f.length;for(n=0;o>n;++n)t+='<div id="menu_item_'+f[n].id+'" class="menu_item" touch-action="none">'+f[n].title+"</div>";for(t+="</div>",t+="</div>",e("#menu_content").innerHTML=t,n=0;o>n;++n)i(e("#menu_item_"+f[n].id),f[n])}function r(){e("#menu_content").innerHTML=""}function a(){return h?!1:(h=!0,o(),u=e.click(m,function(){s(),p.onCancel&&p.onCancel()}),m.style.opacity=0,m.style.display="inline-block",d.fadeIn(m,80),!0)}function s(){return h?(u.remove(),u=null,d.fadeOut(m,80,function(){m.style.display="none",r(),h=!1,p.onClose&&p.onClose()}),!0):!1}function c(){h?s():a()}function l(){u.remove(),m=null,p={},g={}}var u,d=t.anim,f=t.items,h=!1,m=e("#menu_bg"),p={onSelect:t.onSelect,onCancel:t.onCancel,onClose:t.onClose},g={title:t.title,text:t.text};return t=null,{open:a,close:s,toggle:c,render:o,setItems:n,release:l}},a=function(e,t){function i(){a=null,o=null,t&&t(!0)}var o=n(),a=r({anim:o,title:e,text:"&nbsp;",items:[{id:"ok",title:"Okay"}],onSelect:i,onCancel:i});a.open()},s=function(e,t){function i(e){a=null,o=null,t&&t(e)}var o=n(),a=r({anim:o,title:e,text:"&nbsp;",items:[{id:"ok",title:"Okay"},{id:"cancel",title:"Cancel"}],onSelect:function(e){i("ok"===e)},onCancel:function(){i(!1)}});a.open()},c=function(){function t(e,t,n,i){var o=1;return i>t&&n>e&&(t*=n/e,e=n),t>i&&(o=i/t,e*=o,t=i),e>n&&(o=n/e,t*=o,e=n),{w:Math.round(e),h:Math.round(t)}}function n(n){function l(e){c&&(e.stopPropagation(),e.preventDefault(),m.popUrl(),h())}function u(e,t,n){var i,o,r;if(!e||e.length<1)return null;for(i=0,o=e.length;o>i;++i)if(r=e[i],r.width>=t||r.height>=n)return r;return e[o-1]}function d(){if(c){var n=e("#image_viewer_img");if(n){var i=t(w.width,w.height,p.width,p.height);n.style.width=i.w+"px",n.style.height=i.h+"px"}}}function f(n,s,l){var u=t(s,l,p.width,p.height),d=i;d.innerHTML='<img id="image_viewer_img" src="'+n+'" style="width:'+u.w+"px;height:"+u.h+'px;opacity:0;cursor:pointer"/>';var f=e("#image_viewer_img");f.complete?g.fadeIn(f,r):f.onload=function(){g.fadeIn(f,a)},c=!0,v=n,w.width=s,w.height=l,o.style.display="block",o.style.opacity=0,g.fadeIn(o,200),m.updateUrl("/viewer")}function h(){c&&g.fadeOut(o,s,function(){o.style.display="none",i.innerHTML="",c=!1})}n=n||{};var m=n.router,p=n.rcApp,g=n.anim,v="",w={width:0,height:0};n=null,i=i||e("#viewer_content"),o=o||e("#viewer_bg");e.click(i,l);return{open:f,close:h,resize:d,isOpen:function(){return c},curUrl:function(){return v},selectImgSize:u,fitRc:t}}var i,o,r=200,a=200,s=150,c=!1;return n}(),l=function(){function t(e){if(!e||"string"!=typeof e)return!1;var t=e.trim();return t.length<1||t.length>i?!1:t.match(o)?!1:t}function n(n){function i(e){e=e||{},f=e.subs,h.onSelect=e.onSelect,h.onAdd=e.onAdd,h.onDelete=e.onDelete}function o(t){e.click(t,function(){h.onSelect&&h.onSelect(t.getAttribute("data-feed"))},!1,"subreddit_item_press")}function r(t){e.click(t,function(n){n.stopPropagation();var i=e("#subreddit_item_"+t.getAttribute("data-sub"));if(!i||!i.parentNode)return void console.warn("sub delete button had no parent element");var o=i.getAttribute("data-feed");s("Are you sure you want to delete the subreddit "+o+"?",function(e){e&&(console.log("removing ",o),d(o),h.onDelete&&h.onDelete(o),i=null,t=null)})},!1,"subreddit_item_delete_press")}function a(e){var t='<div id="subreddit_item_'+e+'" class="subreddit_item" data-feed="'+e+'"><div class="subreddit_item_text">/r/'+e+'</div><div class="subreddit_item_delete" data-sub="'+e+'" id="btn_delete_subreddit_'+e+'">-</div><br clear="all"></div>';return t}function c(t){for(var n,i,s='<div id="subreddit_item_Frontpage" class="subreddit_item" data-feed="">Frontpage</div>',c=0,l=f.length;l>c;++c)i=f[c],s+=a(i);for(t.innerHTML=s,c=0;l>=c;++c)i=c>0?f[c-1]:"Frontpage",o(e("#subreddit_item_"+i)),(n=e("#btn_delete_subreddit_"+i))&&r(n)}function l(e){if(!t(e))return!1;e=e.toLowerCase();for(var n=0,i=f.length;i>n;++n)if(e===f[n].toLowerCase())return!0;return!1}function u(n){var i,s,c,l,u,d="";if(!(n=t(n)))throw"Invalid subreddit";for(c=n.toLowerCase(),i=0,s=f.length;s>i;++i){if(l=f[i].toLowerCase(),c===f[i].toLowerCase())throw"The sub "+n+" was already added";if(l>c)break}f.splice(i,0,n),d=a(n);var m=i>0?f[i-1]:"Frontpage";e("#subreddit_item_"+m).insertAdjacentHTML("afterend",d),u=e("#subreddit_item_"+n),o(u),r(e("#btn_delete_subreddit_"+n)),e("#txt_subreddit_add").value="";var p=e("#left_panel_content"),g=p.getBoundingClientRect(),v=u.getBoundingClientRect(),w=p.scrollTop;return console.log("scrollTop = "+w),v.top<g.top&&(w=Math.max(w-(g.top-v.top)-10,0),p.scrollTop=Math.round(w),console.log("scrolled to "+w)),h.onAdd&&h.onAdd(n),!0}function d(t){if(t){for(var n=0,i=f.length;i>n;++n)if(f[n].toLowerCase()===t.toLowerCase()){f.splice(n,1);break}var o=e("#subreddit_item_"+t);o&&o.parentNode.removeChild(o),h.onDelete&&h.onDelete(t)}}var f=null,h={onSelect:null,onAdd:null,onDelete:null};return i(n),n=null,{render:c,subExists:l,addSub:u,deleteSub:d,subs:f}}var i=40,o=/[^0-9A-Za-z_]/;return n}(),u=function(){function t(t){function l(e){E.images=!!e.images}function u(t,n){if(!t||!t.author)return"";var i,o,r,a='<div class="article_comment_block"><div class="article_comment_head"><b>'+t.author+"</b> "+t.score+" points "+e.date.toAgeString(+t.created_utc,n)+(t.edited?"*":"")+'</div><div class="article_comment_body">'+e.html.prep(t.body_html)+"</div>";if(t.replies&&t.replies.data&&t.replies.data.children)for(r=t.replies.data.children,o=r.length,i=0;o>i;++i)a+=u(r[i].data,n);return a+="</div>"}function d(){var e=Date.now();for(var t in L)e-L[t].time>i&&delete L[t]}function f(t,n,i){d(),L[t]&&Date.now()-L[t].time<6e4&&(console.log("using cached article"),n&&n(L[t].data)),e.xhr(A+"://www.reddit.com"+t+".json",{success:function(e){var o;try{o=JSON.parse(e)}catch(r){return void(i&&i("Failed to parse json feed: "+r))}L[t]={time:Date.now(),data:o},n&&n(o)},error:function(e){i&&i("Failed to load json feed: "+e)},accept:"application/json"})}function h(e){return Math.round(1e3*e/18)/1e3}function m(t){var n,i,o,r,a,l,u,d,f,m,p,g,v,w,_=c,b=s;if(!E.images)return null;if(t.preview&&(r=t.preview.images)&&r.length>0&&(a=r[0],(r=a.resolutions)&&(l=r.length)>0&&(u=C.selectImgSize(r,c*e.browser.pixelRatio,s*e.browser.pixelratio),d=C.selectImgSize(r,e.browser.screenSize.width,e.browser.screenSize.height),_=d.width,b=d.height,f=d.width,m=d.height,i=u.url,o=d.url)),!i){if(!t.thumbnail)return null;i=t.thumbnail,o=t.thumbnail,f=_,m=b}return i.indexOf("http://")<0&&i.indexOf("https://")<0?null:(e.browser.isSecure&&(i=t.thumbnail,i=i.replace("http://","https://"),o=o.replace("http://","https://")),p=Math.min(Math.round(_/b*s),c),g=s,v=h(p)+"em",w=h(g)+"em",n='<img id="article_image_thumb" src="'+i+'" class="article_image_img" touch-action="none" style="width:'+v+";height:"+w+';opacity:0"/>',{html:n,url:o,width:f,height:m})}function p(t,n){e("#article_panel_content").style.opacity="0";var i=t[0].data.children[0].data,o=!!i.is_self,s=m(i);s&&(e("#article_image_block").innerHTML=s.html,e.click(e("#article_image_thumb"),function(){C.open(s.url,s.width,s.height)}));var c="";c=i.url&&!o?'<a href="'+i.url+'" target="_blank">'+i.title+"</a>":i.title,e("#article_title").innerHTML=c;var l=Math.round(Date.now()/1e3),d=i.subreddit?"/r/"+i.subreddit:"";e("#article_info").innerHTML=i.domain+" [<b>+"+i.score+"</b>] <b>"+d+"</b> "+e.date.toAgeString(+i.created_utc,l)+" by "+i.author,i.selftext_html?e("#article_body").innerHTML='<p style="font-size:0.1em">&nbsp;</p>'+e.html.prep(i.selftext_html):e("#article_body").innerHTML="";var f,h,p=t[1].data.children,g=p.length;for(c="",h=0;g>h;++h)f=p[h].data,c+=u(p[h].data,l);e("#article_comments").innerHTML=c,S.fadeIn(e("#article_panel_content"),r,n);var v=e("#article_image_thumb");v&&(v.complete?S.fadeIn(v,a):v.onload=function(){S.fadeIn(v,a)})}function g(t){e("#article_loading").style.display="block",f(t,function(t){window.setTimeout(function(){e("#article_loading").style.display="none",p(t)},10)})}function v(){e("#article_title").innerHTML="",e("#article_info").innerHTML="",e("#article_image_block").innerHTML="",e("#article_body").innerHTML="",e("#article_comments").innerHTML=""}function w(t,n){return T?void console.warn("article already open"):(e("#article_panel_content").style.opacity="0",v(),void O.go(o.CENTER,function(){T=!0,g(t),n&&n()}))}function _(e){return T?(C.close(),void O.go(o.RIGHT,function(){T=!1,e&&e()})):void console.warn("article already closed")}function b(){O.resize(),C.isOpen()&&C.resize()}t=t||{};var y=t.elPanel,x=t.elScroll,k=t.rcApp,S=n(),C=t.viewer,M={onSlideClose:t.onSlideClose},T=!1,L=Object.create(null),A=window.location.protocol.indexOf("https")>=0?"https":"http",E={images:!!t.images};t=null;var O=o({elPanel:y,elScroll:x,state:o.RIGHT,xSlideCenter:0,xSlideLeft:0,xSlideRight:1,hideDistRight:40,springDur:300,rcApp:k,anim:S,onMove:null,onChange:function(e){var t=T;T=e===o.CENTER,!T&&t!==T&&M.onSlideClose&&M.onSlideClose()}});return{load:f,render:p,clear:v,loadAndRender:g,open:w,close:_,isOpen:function(){return T},resize:b,setOptions:l}}var i=6e4,r=300,a=200,s=133,c=200;return t}(),d=function(){function t(t){function r(e){E.thumbs=!!e.thumbs}function a(){O||(e("#feed_panel").disabled=!0,O=!0)}function s(){O&&(e("#feed_panel").disabled=!1,O=!1)}function c(t,n){t&&t.getAttribute("data-permalink")&&e.click(t,function(){T.onSelect&&T.onSelect(t.getAttribute("data-permalink"))},!1,n)}function l(t,n,i,o){R&&R.remove(),R=e.click(t,function(){t.innerHTML="loading...",h(n,i,function(e){_(n,e,o)})})}function u(t){t.complete?L.fadeIn(t,200):t.onload=function(){L.fadeIn(t,200)};var n=t.getAttribute("data-url");n&&e.click(t,function(){A.open(n,+t.getAttribute("data-width"),+t.getAttribute("data-height"))})}function d(t,n,o,r){H++;var a=!S||H>1||t?i+(t?"r/"+t:"")+".json":"data/frontpage.json";C=t,M="",e.xhr(a,{success:function(i){var a;try{a=JSON.parse(i)}catch(s){return void(r&&r("Failed to parse json feed/about: "+s))}!t||e.string.cieq(t,"frontpage")||e.string.cieq(t,"all")?o&&o():m(t,o,r),n&&n(a)},error:function(e){r&&r("Failed to load json feed/about: "+e)},accept:"application/json"})}function f(t,n,o){var r=i+(C?"r/"+C:"")+(t?"/"+t:"")+".json";M=t,e.xhr(r,{success:function(e){var t;try{t=JSON.parse(e)}catch(i){return void(o&&o("Failed to parse reloaded json feed: "+i))}n&&n(t)},error:function(e){o&&o("Failed to reload json feed: "+e)},accept:"application/json"})}function h(t,n,o,r){var a=i+(t?"r/"+t:"")+(M?"/"+M:"")+".json?after="+n;e.xhr(a,{success:function(e){var t;try{t=JSON.parse(e)}catch(n){return void(r&&r("Failed to parse json feed/about: "+n))}o&&o(t)},error:function(e){r&&r("Failed to load json feed/about: "+e)},accept:"application/json"})}function m(t,n,o){var r=!S||H>1?i+(t?"r/"+t+"/":"")+"about.json":"data/about.json";e.xhr(r,{success:function(e){var t;try{t=JSON.parse(e)}catch(i){return void(o&&o("Failed to parse json feed: "+i))}n&&n(t)},error:function(e){o&&o("Failed to load json feed: "+e)},accept:"application/json"})}function p(t){var n,i,o,r,a=0,s=0,c="";if(!t||!t.thumbnail)return"";var l=t.thumbnail;if(l.indexOf("http://")<0&&l.indexOf("https://")<0)return"";e.browser.isSecure&&(l=l.replace("http://","https://")),t.preview&&(n=t.preview.images)&&n.length>0&&(i=n[0],(n=i.resolutions)&&(o=n.length)>0&&(r=A.selectImgSize(n,e.browser.screenSize.width,e.browser.screenSize.height),a=+r.width,s=+r.height,c=r.url,l.indexOf("http://")<0&&l.indexOf("https://")<0?c="":e.browser.isSecure&&(c=c.replace("http://","https://"))));var u='<img id="item_thumb_'+t.id+'" src="'+l+'" class="item_thumb" style="opacity:0" data-url="'+c+'" data-width="'+a+'" data-height="'+s+'"/>';return u}function g(t,n){var i=!!t.is_self,o=t.id,r=E.thumbs?p(t):"",a='<div id="item_'+o+'" class="item"><div class="item_left">'+r+(i?'<p id="item_head_'+o+'" class="item_title" data-permalink="'+t.permalink+'" data-url="'+t.url+'" touch-action="none">'+t.title+"</p>":'<p id="item_head_'+o+'" class="item_title"><a href="'+t.url+'" target="_blank">'+t.title+"</a></p>")+'<p class="item_details">('+t.domain+") "+t.score+" points by "+t.author+" in "+t.subreddit+" "+e.date.toAgeString(+t.created_utc,n)+'</p></div><div id="article_link_'+o+'" data-permalink="'+t.permalink+'" class="item_right"><p id="article_link_c_'+o+'">&ldquo;'+t.num_comments+"&rdquo;</p></div></div>";return a}function v(t,n){n=n||{};var i,o,r=t.length,a="",s=Math.round(Date.now()/1e3);for(o=0;r>o;++o)i=t[o].data,(!i.over_18||n.nsfw)&&(e("#item_"+i.id)||(a+=g(i,s)));return a}function w(t,n,i){i=i||{};var o,r=e("#feed_panel_content"),a=n.data.children,s=a.length,d=0,f='<div id="items" style="opacity:0" data-feed="'+t+'">'+v(n.data.children,i);for(n.data.after&&(f+='<div id="feed_loadmore_block" class="feed_loadmore_block">load more articles...</div>'),f+="</div>",r.innerHTML=f,o=0;s>o;++o)d=a[o].data.id,c(e("#item_head_"+d),"item_left_press"),c(e("#article_link_"+d),"item_right_press");if((r=e("#feed_loadmore_block"))&&l(r,t,n.data.after,i),E.thumbs){for(o=0;s>o;++o)d=a[o].data.id,(r=e("#item_thumb_"+d))&&u(r);r=null}L.fadeIn(e("#items"),400,i.complete)}function _(t,n,i){var o,r;if(!(o=e("#feed_loadmore_block")))return void console.warn("Couldn't find feed_loadmore_block element");var a=v(n.data.children,i);o.insertAdjacentHTML("beforebegin",a);var s,d,f=n.data.children,h=f.length;for(s=0;h>s;++s)d=f[s].data.id,c(e("#item_head_"+d)),c(e("#article_link_"+d));if(E.thumbs){for(s=0;h>s;++s)d=f[s].data.id,(r=e("#item_thumb_"+d))&&u(r);r=null}n.data.after?(l(o,t,n.data.after,i),o.innerHTML="load more articles..."):o.style.display="none"}function b(t){var n=t&&t.data?t.data:{},i="";"number"==typeof n.subscribers&&(i+="<p>Subscribers: "+(n.subscribers||"")+"</p>"),i+=e.html.prep(n.description_html||""),e("#feed_meta_name").innerHTML=n.title||"",e("#feed_meta_body").innerHTML=i}function y(t){var n=t?"/r/"+t:"Frontpage";e("#feed_title_text").innerHTML=n,e("#feed_panel_content").innerHTML=""}function x(t,n){n=n||{};var i=t?"/r/"+t:"Frontpage";e("#feed_title_text").innerHTML=i,e("#feed_panel_content").innerHTML='<br/><div class="loading_message">loading...</div>',d(t,function(e){w(t,e,{nsfw:n.nsfw}),n.complete&&n.complete()},function(e){b(e),n.completeMeta&&n.completeMeta()})}function k(t){var n=t.order;(o.indexOf(n)<0||"hot"===n)&&(n=""),e("#feed_panel_content").innerHTML='<br/><div class="loading_message">loading...</div>',f(n,function(e){w(C,e,{nsfw:t.nsfw}),t.complete&&t.complete()})}t=t||{};var S=e.browser.domainIsLocal(),C="",M="",T={onSelect:t.onSelect},L=n(),A=t.viewer,E={thumbs:!!t.thumbs};t=null;var O=!1,R=null,H=0;return{clear:y,load:d,render:w,loadAndRender:x,reloadAndRender:k,setOptions:r,disable:a,enable:s}}var i=e.browser.protocol+"//www.reddit.com/",o=["hot","new","rising","controversial","top"];return t}(),f=function(e){function t(e){var t;t=(-u.width*l+e)/2,h.setPos(d.left,t,0),t=(u.width*(2-l)+e)/2,h.setPos(d.right,t,0)}function i(e){var t=p;t!==e&&(p=e,f.onChange&&f.onChange(p,t))}function r(){m.resize()}function a(e){m.go(o.CENTER,function(){p=o.CENTER,e&&e()})}function s(e){m.go(o.RIGHT,function(){p=o.RIGHT,e&&e()})}function c(e){m.go(o.LEFT,function(){p=o.LEFT,e&&e()})}e=e||{};var l="number"==typeof e.maxSlide?e.maxSlide:.825,u=e.rcApp,d={main:e.elMain,left:e.elLeft,right:e.elRight},f={onChange:e.onChange||null},h=n(),m=o({elPanel:d.main,elScroll:e.elScroll,state:0,xSlideCenter:0,xSlideLeft:-l,xSlideRight:l,springDur:200,rcApp:u,anim:h,onMove:t,onChange:i}),p=o.CENTER;return e=null,{setSlidePos:t,gotoMain:a,gotoLeft:s,gotoRight:c,resize:r,curPanel:function(){return p}}},h=function(){function t(){var t;if(!e.cookies.exists(r))return!1;try{t=JSON.parse(e.cookies.get(r))}catch(n){return console.warn("Failed to parse previously saved cookie prefs:",n),!1}if(t.subs)for(var i=u.length=t.subs.length,o=0;i>o;++o)u[o]=t.subs[o];if(t.options){var a=t.options;c.theme=null,a.theme&&s.indexOf(a.theme)>=0&&(c.theme=a.theme),c.article_images="boolean"==typeof a.article_images?a.article_images:!0,c.thumb_images="boolean"==typeof a.thumb_images?a.thumb_images:!0,c.history="boolean"==typeof a.history?a.history:!e.browser.isMobile.iOS(),c.nsfw=!!a.nsfw,c.savecookie=!0}return console.log("loaded prefs from cookie"),!0}function n(){if(!l)return!1;if(c.savecookie){var t={options:c,subs:u};e.cookies.set(r,JSON.stringify(t),new Date(Date.now()+31536e6)),console.log("saved prefs in cookie")}else e.cookies.exists(r)&&(e.cookies.remove(r),console.log("deleted prefs cookie"));return l=!1,!0}function i(e,t){return c[e]!==t?(c[e]=t,o(),!0):!1}function o(){l=!0}var r="freddy_prefs",a=["all","art","askreddit","books","funny","gadgets","gamedev","gaming","javascript","movies","music","pics","programming","science","television","videos","webdev","worldnews"],s=["light","dark"],c={theme:null,article_images:!0,thumb_images:!0,nsfw:!1,history:!e.browser.isMobile.iOS(),savecookie:!0},l=!1,u=a.slice();return{load:t,save:n,notifyChange:o,setOption:i,options:c,subs:u}},m=function(e,t,n){e&&"object"==typeof e?this.copy(e):(this.name=e,this.rx=t,this.fn=n)};m.prototype.copy=function(e){return this.name=e.name,this.rx=e.rx,this.fn=e.fn,this},m.prototype.constructor=m;var p=function(e,t){function n(e){"boolean"==typeof e.useHashes&&w!==e.useHashes&&(w=e.useHashes,w?window.addEventListener("hashchange",p):window.removeEventListener("hashchange",p))}function i(e){return"useHashes"===e?w:void 0}function o(){S=[_]}function r(e){var t=e||"";if(t=t.trim(),!t)return t;var n=t.lastIndexOf("#");return n>=0&&(t=t.substr(n+1).trim()),!t||t.length>C||!t.match(M)?"":t}function a(t){if(e.hasOwnProperty(t.name))throw"Route '"+t.name+"' already exists";return e[t.name]=t,!0}function s(t){if(!t)return null;for(var n=0,i=e.length;i>n;++n)if(e[n].name.toLowerCase()===t.toLowerCase())return e[n];return null}function c(t){var n;if(!t){if(!(n=s(v)))throw"Default route '"+v+"' not found";return n}for(var i in e)if(e.hasOwnProperty(i)&&(n=e[i],t.match(n.rx)))return console.log("Matched url",t,"to route",n.name),n;return null}function l(e){var t,n=r(e);if(b===n)return!1;if(!(t=c(n)))throw"Could not match any route for url: '"+n+"'";return b=t,y=n,t.go(n),!0}function u(e){l(e)&&S.push(e)}function d(e){w?(e=r(e),document.location.hash=e?"#"+e:""):u(e);
}function f(){if(S.length<=1)throw"Cannot go back, history stack empty.";if(S.pop(),w)k=!0,window.history.back();else{var e=S.length,t=e>0?S[e-1]:"";l(t)}}function h(){if(w){var e=y?"#"+y:"";x=!0,window.location.hash=e}}function m(e){var t=r(e),n=c(t);n||console.warn("failed to match route to url:",e),S.push(y),b=n,y=t,h()}function p(){if(x)return void(x=!1);var e=window.location.hash;k?(k=!1,l(e)):u(e)}function g(){if(S.length<=1)throw"popUrl: stack empty";S.pop(),y=S.length>0?S[S.length-1]:"",b=c(y),w&&(x=!0,window.history.back())}e=e||[],t=t||{};var v=t.defaultRouteName||"home",w=!!t.useHashes,_=t.defaultUrl||"";t=null;var b=e.length>0?s(v):null,y=_,x=!1,k=!1,S=[y],C=250,M=/^[0-9A-Za-z_\-\/]*$/;return w&&window.addEventListener("hashchange",p),{go:d,back:f,add:a,getRouteByName:s,curRoute:function(){return b},curUrl:function(){return y},setOptions:n,getOption:i,clearHistory:o,gotoUrl:l,pushUrl:u,onHashChange:p,updateHash:h,updateUrl:m,popUrl:g,sanitizeUrl:r,matchRoute:c}},g=function(){function i(){function i(){e.browser.isFramed&&(window.top.location.href=window.location.href),T=new t(e("#container").getBoundingClientRect()),z=h(),z.load();var i=z.options;e("#btn_theme").textContent=i.theme?e.string.capitalize(i.theme):"Default",e("#chk_article_images").checked=!!i.article_images,e("#chk_thumb_images").checked=!!i.thumb_images,e("#chk_nsfw").checked=!!i.nsfw,e("#chk_history").checked=!!i.history,e("#chk_savecookie").checked=!!i.savecookie,i.theme&&k(i.theme),console.log((i.history?"":"not ")+"using history states"),L=n(),F=p([{name:"home",rx:/^\/home$/,go:v},{name:"options",rx:/^\/options$/,go:b},{name:"sidebar",rx:/^\/sidebar$/,go:y},{name:"article",rx:/^\/r\/[0-9A-Za-z\-_]+\/comments\/[0-9A-Za-z\-_]+\/[0-9A-Za-z\-_]+/,go:x},{name:"feed",rx:/\/r\/[0-9A-Za-z\-_]+$/,go:_},{name:"viewer",rx:/^\/viewer$/,go:function(){}}],{defaultRouteName:"home",useHashes:z.options.history}),A=c({rcApp:T,anim:L,router:F}),E=r({anim:L,title:"Sort by",items:[{id:"hot",title:"Hot"},{id:"new",title:"New"},{id:"rising",title:"Rising"},{id:"controversial",title:"Controversial"},{id:"top",title:"Top"}],onSelect:function(e){P.reloadAndRender({order:e,nsfw:i.nsfw})}}),O=r({anim:L,title:"Select Theme",items:[{id:"default",title:"Default"},{id:"light",title:"Light"},{id:"dark",title:"Dark"}],onSelect:function(e){k(e)}}),R={feed:e("#feed_panel"),left:e("#left_panel"),right:e("#right_panel"),article:e("#article_panel")},P=d({rcApp:T,viewer:A,thumbs:i.thumb_images,onSelect:function(e){F.go(e)}}),D=u({elPanel:e("#article_panel"),elScroll:e("#article_panel_content"),rcApp:T,viewer:A,images:i.article_images,onSlideClose:function(){F.popUrl()}}),H=l({subs:z.subs,onSelect:function(e){var t=e?"/r/"+e:"";F.go(t)},onAdd:function(e){z.notifyChange(),console.log("added sub:",e)},onDelete:function(e){z.notifyChange(),console.log("removed sub:",e)}}),H.render(e("#subreddit_list"));var o="";if(i.history){var a=window.location.hash,m=F.sanitizeUrl(a);if(m){var w=F.matchRoute(m);w?"feed"===w.name?o=m.substr(3).replace("/",""):"article"===w.name?(F.updateHash(""),F.pushUrl(m)):F.updateHash(""):F.updateHash("")}}P.loadAndRender(o),L.setPos(R.article,T.width+s,0),R.article.style.visibility="visible",I=f({rcApp:T,elMain:e("#feed_panel"),elLeft:e("#left_panel"),elRight:e("#right_panel"),elScroll:e("#feed_panel_content"),onChange:C}),e.browser.isStandalone&&(e("#homescreen_note").style.display="none"),console.log("initializing events"),g()}function g(){e.click(e("#btn_feed_l"),function(){var e=I.curPanel();e===o.CENTER?F.go("/options"):e===o.RIGHT&&(setTimeout(S,600),F.back())},!1,"btn_arrow_press"),e.click(e("#btn_feed_r"),function(){var e=I.curPanel();e===o.CENTER?F.go("/sidebar"):e===o.LEFT&&F.back()},!1,"btn_arrow_press"),e.click(e("#btn_article_close"),function(){F.back()},!1,"btn_arrow_press"),e("#btn_subreddit_add").onclick=function(){try{H.addSub(e("#txt_subreddit_add").value)}catch(t){a(t)}this.blur()},e("#txt_subreddit_add").onkeyup=function(t){13===t.keyCode&&e("#btn_subreddit_add").focus()},e("#btn_theme").onclick=function(){I.curPanel()===o.RIGHT&&O.toggle(),this.blur()},e("#chk_nsfw").onchange=function(){z.setOption("nsfw",!!this.checked)},e("#chk_article_images").onchange=function(){var e=!!this.checked;z.setOption("article_images",e),D.setOptions({images:e})},e("#chk_thumb_images").onchange=function(){var e=!!this.checked;z.setOption("thumb_images",e),P.setOptions({thumbs:e})},e("#chk_history").onchange=function(){z.setOption("history",!!this.checked)},e("#chk_savecookie").onchange=function(){z.setOption("savecookie",!!this.checked)},e.click(e("#btn_feed_menu"),function(){0===I.curPanel()&&E.toggle()}),window.addEventListener("resize",M),console.log("running")}function v(){w("")}function w(e){return A.isOpen()?void A.close():D.isOpen()?void D.close(function(){P.enable()}):j===e?void I.gotoMain():(P.clear(),void setTimeout(function(){I.gotoMain(function(){P.loadAndRender(e,{nsfw:z.options.nsfw}),j=e})},100))}function _(e){if(e&&"/r/"!==e||w(""),0!==e.indexOf("/r/"))throw"Unrecognized feed url: "+e;var t=e.substr(3);if("/"===t.charAt(t.length-1)&&(t=t.substr(0,t.length-1)),!t.match(/^[A-Za-z0-9_\-]+$/))throw"Bad feed: '"+t+"' url: "+e;w(t)}function b(){var e=I.curPanel();e===o.CENTER&&I.gotoLeft(),D.isOpen()&&D.close()}function y(){var e=I.curPanel();e===o.CENTER&&I.gotoRight(),D.isOpen()&&D.close()}function x(e){return A.isOpen()?void A.close():(P.disable(),void D.open(e))}function k(t){if(t=t||null,"default"===t&&(t=null),t&&m.indexOf(t)<0)return void console.warn("Unrecognized theme:",t);var n=(t?t:"default")+".css",i=e("#css_theme");i?i.href="css/themes/"+n:document.body.insertAdjacentHTML("beforeend",'<link type="text/css" id="css_theme" rel="stylesheet" href="css/themes/'+n+'" media="screen"/>');var o="#333333";"light"===z.options.theme?o="#888888":"dark"===z.options.theme&&(o="#222222"),(i=e("#meta_theme_color"))&&(i.content=o),(i=e("#meta_ios_theme_color"))&&(i.content=o),i=null,z.setOption("theme",t),e("#btn_theme").textContent=t?e.string.capitalize(t):"Default"}function S(){var e=F.getOption("useHashes");z.save(),F.setOptions({useHashes:z.options.history}),e&&!z.options.history?(window.history.go(-window.history.length),window.location.hash=""):!e&&z.options.history&&F.updateHash("")}function C(e,t){e!==t&&(t===o.RIGHT&&S(),e===o.RIGHT?F.updateUrl("/options"):e===o.LEFT?F.updateUrl("/sidebar"):e===o.CENTER&&F.popUrl())}function M(){T.copy(e("#container").getBoundingClientRect()),I.resize(),D.resize()}var T=null,L=null,A=null,E=null,O=null,R={},H=null,P=null,D=null,I=null,z=null,F=null,j="";return{run:i}}var s=40,m=["light","dark"];return i}();window.addEventListener("load",function(){g().run()},!1);}());
</script>
</body>
</html>
